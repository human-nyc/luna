<div :class="{'header': true, 'header_scrolled': isScrolled, 'header_open': mobileMenuIsOpen, 'header_light_content': lightContent }" id="headerComponent" @mouseleave="toggleActiveChildLinks({activeChildLinksIndex: -1})">

  <div :class="['header__dropdown', 'header__dropdown--mobile' , { active: mobileMenuIsOpen }]" v-cloak>
    {% render 'linklist', linklist: linklists[section.settings.main_nav_mobile], class: 'header__dropdown-inner' v_cloak: true %}
    {% render 'customer-links' %}
  </div>

  {% for parent_link in linklists[section.settings.main_nav_left].links %}
    {% if parent_link.links.size > 0 %}
      <div :class="['header__dropdown', { active: activeChildLinksIndex == {{forloop.index0}} }]">
        <div class="header__dropdown-inner">
          {% for child_link in parent_link.links %}
            {% case child_link.type %}
            {% when 'product_link' %}
              {% assign child_link_image = child_link.object.featured_image %}
            {% when 'collection_link' %}
              {% assign child_link_image = child_link.object.image %}
            {% endcase %}

            <div class="dropdown-item" data-type="{{child_link.type}}">
              <a href="{{child_link.url}}" class="dropdown-image">
                <img loading="lazy" src="{{child_link_image | img_url: '80x80', crop: 'center', scale: 2 }}" alt="Collection 1" />
              </a>
              <a href="{{child_link.url}}" class="dropdown-text">{{child_link.title}}</a>

              {% if child_link.links.size > 0 %}
                <ul class="grandchild-links">
                  {% for grandchild_link in child_link.links %}
                    <li><a href="{{grandchild_link.url}}" class="grandchild-link">{{grandchild_link.title}}</a></li>
                  {% endfor %}
                </ul>
              {% endif %}
              </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}
  {% endfor %}

  <div class="header__main">
    <div class="header__main-inner">
      <div class="header__left" v-cloak>
        {% for parent_link in linklists[section.settings.main_nav_left].links %}

          <a :class="['header-link', { active: activeChildLinksIndex == {{forloop.index0}} }]" href="{{parent_link.url}}" @mouseover="toggleActiveChildLinks({activeChildLinksIndex: {{forloop.index0}}})">{{parent_link.title}}</a>

        {% endfor %}


        <div class="header__toggler" @click="toggleMobileMenu">
          <div class="toggle-icon">
            <div class="toggle-icon_bar-one"></div>
            <div class="toggle-icon_bar-two"></div>
            <div class="toggle-icon_bar-three"></div>
          </div>
        </div>
      </div>
      <div class="header__center" v-cloak>
        <div class="header__logo">
          <a href="/">
            {% render 'svg-logo' %}
          </a>
        </div>
      </div>
      <div class="header__right" v-cloak>
        {% render 'customer-links' %}
        <a
          @click.prevent='toggleMiniCart'
          class="header-link header-link_cart"
          href="/cart">Cart<span v-cloak> (${cartCount})</span></a>
      </div>
    </div>
  </div>
</div>

{% comment %}
{% render 'linklist' linklist: linklists.main-menu %}
{% endcomment %}

{% schema %}
  {
    "name": "Header",
    "settings": [
      {
        "type": "text",
        "id": "promo_text",
        "label": "Promotional Text",
        "default": "Promo Here"
      },
      {
        "type": "link_list",
        "id": "main_nav_left",
        "label": "Main Navigation Desktop Left",
        "default": "main-menu"
      },
      {
        "type": "link_list",
        "id": "main_nav_mobile",
        "label": "Main Navigation Mobile",
        "default": "main-menu"
      }
    ],
    "blocks": []
  }
{% endschema %}
